# Complex-Query-Decomposition-for-Natural-Language-Questions-on-Knowledge-Graphs

We use the *DecompRC* model (https://github.com/shmsw25/DecompRC) to generate the singlehop questions and do the recomposition of the multihop answer and we also use *MuHeQA* system (https://github.com/librairy/MuHeQA) to answer these singlehop questions.

We provide the following files:
- **run_decomposition.py** → Modified *run_decomposition.py* file from the *DecompRC* repository.
- **test_muheqa.py** → Python code to generate the answers to the subquestions using the MuHeQA model.
- **evaluation.py** → Python code to evaluate the generated answers to the complex question using a series of NLP metrics.
- **results_metrics.xlsx** → Results obtained by our evaluation process for the *HOTPOTQA 2.0* and *LC-QuAD 2.0* dataset samples of size 30, 150 and 500.
- **hotpot-all** zip → Contains the testing HOTPOTQA 2.0 dataset in SQUAD format.
- **LC-QuAD** zip → Contains the testing LC-QuAD 2.0 dataset in SQUAD format.

We adapt the file **main.py** from the *DecompRC* model, specifically we comment line 519 when using the *LC-QuAD* dataset given that it does not have context.
```
#assert (is_bridge and not is_intersec) or (is_intersec and not is_bridge)
```

We modify the file **run_decomposition.py** to able to recompose the complex answers given the *MuHeQA* answers. The recomposition originally based its selection on logit and no-logit values of the answers. Given that *MuHeQA* does not generate this values, we modify the code to base its selection on probability values, which are generated by both *DecompRC* and *MuHeQA*. Replace the **run_decomposition.py** file from the DecompRC repository with the **run_decomposition.py** we provide.

To generate the answers using the *MuHeQA* system we follow the following process:
- Generate the complex question recomposition using the **main.py** file as described in the *DecompRC* repository.
- Separate the sub-questions using the modified **run_decomposition.py** file as described in the *DecompRC* repository.
- Answer the sub-questions using the **test_muheqa.py** file.
- Recompose the complex answer with the **run_decomposition.py** file as described in the *DecompRC* repository.
